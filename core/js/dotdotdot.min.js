/*
 *	jQuery dotdotdot 1.5.7
 *
 *	Copyright (c) 2013 Fred Heusschen
 *	www.frebsite.nl
 *
 *	Plugin website:
 *	dotdotdot.frebsite.nl
 *
 *	Dual licensed under the MIT and GPL licenses.
 *	http://en.wikipedia.org/wiki/MIT_License
 *	http://en.wikipedia.org/wiki/GNU_General_Public_License
 */(function(e){function n(e,t,n){var r=e.children(),i=!1;e.empty();for(var o=0,u=r.length;o<u;o++){var a=r.eq(o);e.append(a);n&&e.append(n);if(s(e,t)){a.remove();i=!0;break}n&&n.remove()}return i}function r(t,n,o,u,a){var f=t.contents(),l=!1;t.empty();var c="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var h=0,p=f.length;h<p;h++){if(l)break;var d=f[h],v=e(d);if(typeof d=="undefined")continue;t.append(v);a&&t[t.is(c)?"after":"append"](a);d.nodeType==3?s(o,u)&&(l=i(v,n,o,u,a)):l=r(v,n,o,u,a);l||a&&a.remove()}return l}function i(e,t,n,r,u){var l=!1,c=e[0];if(typeof c=="undefined")return!1;var h=r.wrap=="letter"?"":" ",p=f(c).split(h),d=-1,v=-1,m=0,g=p.length-1;while(m<=g){var y=Math.floor((m+g)/2);if(y==v)break;v=y;a(c,p.slice(0,v+1).join(h)+r.ellipsis);if(!s(n,r)){d=v;m=v}else g=v}if(d==-1||p.length==1&&p[0].length==0){var w=e.parent();e.remove();var E=u?u.length:0;if(w.contents().size()>E){var S=w.contents().eq(-1-E);l=i(S,t,n,r,u)}else{var c=w.prev().contents().eq(-1)[0];if(typeof c!="undefined"){var b=o(f(c),r);a(c,b);w.remove();l=!0}}}else{var b=o(p.slice(0,d+1).join(h),r);l=!0;a(c,b)}return l}function s(e,t){return e.innerHeight()>t.maxHeight}function o(t,n){while(e.inArray(t.slice(-1),n.lastCharacter.remove)>-1)t=t.slice(0,-1);e.inArray(t.slice(-1),n.lastCharacter.noEllipsis)<0&&(t+=n.ellipsis);return t}function u(e){return{width:e.innerWidth(),height:e.innerHeight()}}function a(e,t){e.innerText?e.innerText=t:e.nodeValue?e.nodeValue=t:e.textContent&&(e.textContent=t)}function f(e){return e.innerText?e.innerText:e.nodeValue?e.nodeValue:e.textContent?e.textContent:""}function l(t,n){if(typeof t=="undefined")return!1;if(!t)return!1;if(typeof t=="string"){t=e(t,n);return t.length?t:!1}return typeof t=="object"?typeof t.jquery=="undefined"?!1:t:!1}function c(e){var t=e.innerHeight(),n=["paddingTop","paddingBottom"];for(var r=0,i=n.length;r<i;r++){var s=parseInt(e.css(n[r]),10);isNaN(s)&&(s=0);t-=s}return t}function h(e,t){if(!e)return!1;typeof t=="string"?t="dotdotdot: "+t:t=["dotdotdot:",t];typeof window.console!="undefined"&&typeof window.console.log!="undefined"&&window.console.log(t);return!1}if(e.fn.dotdotdot)return;e.fn.dotdotdot=function(i){if(this.length==0){(!i||i.debug!==!1)&&h(!0,'No element found for "'+this.selector+'".');return this}if(this.length>1)return this.each(function(){e(this).dotdotdot(i)});var o=this;o.data("dotdotdot")&&o.trigger("destroy.dot");o.bind_events=function(){o.bind("update.dot",function(t,i){t.preventDefault();t.stopPropagation();f.maxHeight=typeof f.height=="number"?f.height:c(o);f.maxHeight+=f.tolerance;if(typeof i!="undefined"){if(typeof i=="string"||i instanceof HTMLElement)i=e("<div />").append(i).contents();i instanceof e&&(a=i)}m=o.wrapInner('<div class="dotdotdot" />').children();m.empty().append(a.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var u=!1,l=!1;if(p.afterElement){u=p.afterElement.clone(!0);p.afterElement.remove()}s(m,f)&&(f.wrap=="children"?l=n(m,f,u):l=r(m,o,m,f,u));m.replaceWith(m.contents());m=null;e.isFunction(f.callback)&&f.callback.call(o[0],l,a);p.isTruncated=l;return l}).bind("isTruncated.dot",function(e,t){e.preventDefault();e.stopPropagation();typeof t=="function"&&t.call(o[0],p.isTruncated);return p.isTruncated}).bind("originalContent.dot",function(e,t){e.preventDefault();e.stopPropagation();typeof t=="function"&&t.call(o[0],a);return a}).bind("destroy.dot",function(e){e.preventDefault();e.stopPropagation();o.unwatch().unbind_events().empty().append(a).data("dotdotdot",!1)});return o};o.unbind_events=function(){o.unbind(".dot");return o};o.watch=function(){o.unwatch();if(f.watch=="window"){var t=e(window),n=t.width(),r=t.height();t.bind("resize.dot"+p.dotId,function(){if(n!=t.width()||r!=t.height()||!f.windowResizeFix){n=t.width();r=t.height();v&&clearInterval(v);v=setTimeout(function(){o.trigger("update.dot")},10)}})}else{d=u(o);v=setInterval(function(){var e=u(o);if(d.width!=e.width||d.height!=e.height){o.trigger("update.dot");d=u(o)}},100)}return o};o.unwatch=function(){e(window).unbind("resize.dot"+p.dotId);v&&clearInterval(v);return o};var a=o.contents(),f=e.extend(!0,{},e.fn.dotdotdot.defaults,i),p={},d={},v=null,m=null;p.afterElement=l(f.after,o);p.isTruncated=!1;p.dotId=t++;o.data("dotdotdot",!0).bind_events().trigger("update.dot");f.watch&&o.watch();return o};e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1};var t=1,p=e.fn.html;e.fn.html=function(e){if(typeof e!="undefined")return this.data("dotdotdot")&&typeof e!="function"?this.trigger("update",[e]):p.call(this,e);return p.call(this)};var d=e.fn.text;e.fn.text=function(t){if(typeof t!="undefined"){if(this.data("dotdotdot")){var n=e("<div />");n.text(t);t=n.html();n.remove();return this.trigger("update",[t])}return d.call(this,t)}return d.call(this)}})(jQuery);